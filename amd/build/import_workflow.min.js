/**
 * Workflow step select javascript.
 *
 * @module     tool_trigger/workflow
 * @class      Workflow
 * @copyright  2018 Matt Porritt <mattp@catalyst-au.net>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 * @since      3.4
 */
define("tool_trigger/import_workflow",["jquery","core/str","core/modal_factory","core/modal_events","core/templates","core/ajax","core/fragment","core/notification"],(function($,Str,ModalFactory,ModalEvents,Templates,ajax,Fragment,Notification){var contextid,modalObj,ImportWorkflow={},spinner='<p class="text-center"><i class="fa fa-spinner fa-pulse fa-2x fa-fw"></i><span class="sr-only">Loading...</span></p>';function updateModalBody(){var params={jsonformdata:JSON.stringify({})};modalObj.setBody(spinner),modalObj.setBody(Fragment.loadFragment("tool_trigger","new_import_form",contextid,params))}function processModalForm(e){e.preventDefault();var fileform=modalObj.getRoot().find("form").serialize();modalObj.setBody(spinner),ajax.call([{methodname:"tool_trigger_process_import_form",args:{jsonformdata:JSON.stringify(fileform)}}])[0].done((function(responsejson){var responseobj=JSON.parse(responsejson);"success"==responseobj.errorcode?location.reload(!0):Object.keys(responseobj.message).forEach((function(key){Notification.addNotification({message:responseobj.message[key],type:"error"})})),modalObj.hide()})).fail((function(){Notification.addNotification({message:Str.get_string("errorimportworkflow","tool_trigger"),type:"error"}),modalObj.hide()}))}return ImportWorkflow.init=function(context){contextid=context,Str.get_string("importmodaltitle","tool_trigger").then((function(title){ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL,title:title,body:spinner,large:!0},$("[name=importbtn]")).done((function(modal){(modalObj=modal).getRoot().on(ModalEvents.save,processModalForm),modalObj.getRoot().on(ModalEvents.hidden,updateModalBody),updateModalBody()}))}))},ImportWorkflow}));

//# sourceMappingURL=import_workflow.min.js.map